<div ng-app="app">
  <div ng-controller="songsCtrl">
    <div class="row">
      <div class="col-md-4">
        <h1><%= @song.title %></h1>
          <audio controls>
            <source src="<%= @song.song_url.url %>" type="audio/mpeg">Your browser does not support the audio tag.
          </audio><br>
          <% if current_user %>
            <a href="/songs/<%=@song.id%>/edit">Edit</a>
          <% end %>
          <h1>New Version</h1>

            <%= form_for(@version) do |f| %>
            <%= f.hidden_field :song_id, value: @song.id %>
            <%= f.hidden_field :version_number, value: @version.version_number %>
          <div class="field">
            <%= f.label :message, "Version message:" %><br>
            <%= f.text_field :message %>
          </div><br>

          <div class="field">
            <%= f.label :song_url, "Upload Song" %><br>
            <%= f.file_field :song_url %>
          </div><br>

          <div class="field">
            <%= f.label :unmastered_file, "Upload unmastered song" %><br>
            <%= f.file_field :unmastered_file %>
          </div><br>
        
          <div class="actions">
           <%= f.submit %>
          </div>
          <br>
            <% end %>

            <%= form_tag('/team_members') do %>
          <div class="field">
            <datalist id="users" >
              <option ng-repeat="user in users" value="{{ user.username }}">
            </datalist>
          <%= hidden_field_tag :song_id, @song.id %>
          <%= label_tag :username, "Type a username to add as a team member:"  %>
            <br>
            <input id="username" name="username" type="text" list="users"/>
          </div><br>
        <%= submit_tag 'Add team member'%>
        <% end %>
      </div> 
    
    
    
    <div class="col-md-8">
      <div id="version_page">
        <% @versions.each do |version| %>
        <div class="panel-group" id="accordion">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                Version #<%= version.version_number %>
                </a>
              </h4>
            </div>
            <div id="collapseOne" class="panel-collapse collapse in">
              <div class="panel-body">
                <p><%= version.message %></p>
                  <audio controls>
                    <source src="<%= version.song_url.url %>" type="audio/mpeg">
                    Your browser does not support the audio tag.
                  </audio> 
                <a href="<%= version_download_path(version.id) %>" class="btn btn-warning btn-xs">Download</a>
              </div>
            </div>
          </div>
            <% end %>
        </div>
      </div>
    </div>    
  </div>  
</div> 